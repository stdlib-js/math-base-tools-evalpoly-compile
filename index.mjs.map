{"version":3,"file":"index.mjs","sources":["../632af34d4cb74685e4d3a103aaad4e","../lib/main.js","../lib/index.js"],"sourcesContent":["export default '/home/runner/work/math-base-tools-evalpoly-compile/math-base-tools-evalpoly-compile/lib'","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar join = require( 'path' ).join;\nvar readFile = require( '@stdlib/fs-read-file' ).sync;\nvar replace = require( '@stdlib/string-replace' );\nvar isInteger = require( '@stdlib/assert-is-integer' ).isPrimitive;\n\n\n// VARIABLES //\n\nvar opts = {\n\t'encoding': 'utf8'\n};\nvar dir = join( __dirname, 'templates' );\n\n// Templates:\nvar SINGLE_COEFFICIENT_TEMPLATE = readFile( join( dir, 'single_coefficient.js.txt' ), opts ); // eslint-disable-line id-length\nvar EVALPOLY_TEMPLATE = readFile( join( dir, 'evalpoly.js.txt' ), opts );\nvar EMPTY_TEMPLATE = readFile( join( dir, 'empty.js.txt' ), opts );\nvar LOOP_TEMPLATE = readFile( join( dir, 'loop.js.txt' ), opts );\nvar MAX_CHARS = 68; // max-len (80) - chars already in line ('tab': 4, 'return ': 7, ';': 1)\n\n\n// MAIN //\n\n/**\n* Compiles a module string which exports a function for evaluating a polynomial.\n*\n* @param {NumericArray} c - polynomial coefficients sorted in ascending degree\n* @returns {string} module string exporting a function for evaluating a polynomial\n*\n* @example\n* var str = compile( [ 3.0, 2.0, 1.0 ] );\n* // returns <string>\n*/\nfunction compile( c ) {\n\tvar horner;\n\tvar str;\n\tvar n;\n\tvar m;\n\tvar i;\n\n\tn = c.length;\n\n\t// If no coefficients, the function always returns 0...\n\tif ( n === 0 ) {\n\t\treturn EMPTY_TEMPLATE;\n\t}\n\t// If only one coefficient, the function always returns that coefficient...\n\tif ( n === 1 ) {\n\t\tstr = c[ 0 ].toString();\n\t\tif ( isInteger( c[ 0 ] ) ) {\n\t\t\tstr += '.0';\n\t\t}\n\t\treturn replace( SINGLE_COEFFICIENT_TEMPLATE, '{{coefficient}}', str );\n\t}\n\tm = n - 1;\n\n\t// Avoid exceeding the maximum stack size on V8 by using a simple loop :(. Note that the choice of `500` was empirically determined...\n\tif ( n > 500 ) {\n\t\tstr = '';\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\tstr += '\\t' + c[ i ].toString();\n\t\t\tif ( isInteger( c[ i ] ) ) {\n\t\t\t\tstr += '.0';\n\t\t\t}\n\t\t\tif ( i < m ) {\n\t\t\t\tstr += ',\\n';\n\t\t\t}\n\t\t}\n\t\treturn replace( LOOP_TEMPLATE, '{{coefficients}}', str );\n\t}\n\t// If more than one coefficient, apply Horner's method...\n\thorner = c[ 0 ].toString();\n\tif ( isInteger( c[ 0 ] ) ) {\n\t\thorner += '.0';\n\t}\n\tfor ( i = 1; i < n; i++ ) {\n\t\thorner += ' + (x * ';\n\t\tif ( i < m ) {\n\t\t\thorner += '(';\n\t\t}\n\t\thorner += c[ i ].toString();\n\t\tif ( isInteger( c[ i ] ) ) {\n\t\t\thorner += '.0';\n\t\t}\n\t}\n\t// Close all the parentheses...\n\tfor ( i = 0; i < (2*(n-1))-1; i++ ) {\n\t\thorner += ')';\n\t}\n\tstr = c[ 0 ].toString();\n\tif ( isInteger( c[ 0 ] ) ) {\n\t\tstr += '.0';\n\t}\n\tstr = replace( EVALPOLY_TEMPLATE, '{{coefficient}}', str );\n\tstr = replace( str, '{{horner}}', horner );\n\treturn replace( str, '{{eslint}}', ( horner.length > MAX_CHARS ) ? ' // eslint-disable-line max-len' : '' );\n}\n\n\n// EXPORTS //\n\nmodule.exports = compile;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n/**\n* Compile a module for evaluating a polynomial.\n*\n* @module @stdlib/math-base-tools-evalpoly-compile\n*\n* @example\n* var compile = require( '@stdlib/math-base-tools-evalpoly-compile' );\n*\n* var str = compile( [3.0,2.0,1.0] ); // 3*10^0 + 2*10^1 + 1*10^2\n* // returns <string>\n*/\n\n// MODULES //\n\nvar compile = require( './main.js' );\n\n\n// EXPORTS //\n\nmodule.exports = compile;\n"],"names":["join","require","readFile","sync","replace","isInteger","isPrimitive","opts","encoding","dir","SINGLE_COEFFICIENT_TEMPLATE","EVALPOLY_TEMPLATE","EMPTY_TEMPLATE","LOOP_TEMPLATE","module","exports","c","horner","str","n","m","i","length","toString","lib"],"mappings":";;yQAAA,ICsBIA,EAAOC,QAAS,QAASD,KACzBE,EAAWD,QAAS,wBAAyBE,KAC7CC,EAAUH,QAAS,0BACnBI,EAAYJ,QAAS,6BAA8BK,YAKnDC,EAAO,CACVC,SAAY,QAETC,EAAMT,EDjCK,0FCiCY,aAGvBU,EAA8BR,EAAUF,EAAMS,EAAK,6BAA+BF,GAClFI,EAAoBT,EAAUF,EAAMS,EAAK,mBAAqBF,GAC9DK,EAAiBV,EAAUF,EAAMS,EAAK,gBAAkBF,GACxDM,EAAgBX,EAAUF,EAAMS,EAAK,eAAiBF,GAoF1DO,OAAOC,QApEP,SAAkBC,GACjB,IAAIC,EACAC,EACAC,EACAC,EACAC,EAKJ,GAAW,KAHXF,EAAIH,EAAEM,QAIL,OAAOV,EAGR,GAAW,IAANO,EAKJ,OAJAD,EAAMF,EAAG,GAAIO,WACRlB,EAAWW,EAAG,MAClBE,GAAO,MAEDd,EAASM,EAA6B,kBAAmBQ,GAKjE,GAHAE,EAAID,EAAI,EAGHA,EAAI,IAAM,CAEd,IADAD,EAAM,GACAG,EAAI,EAAGA,EAAIF,EAAGE,IACnBH,GAAO,KAAOF,EAAGK,GAAIE,WAChBlB,EAAWW,EAAGK,MAClBH,GAAO,MAEHG,EAAID,IACRF,GAAO,OAGT,OAAOd,EAASS,EAAe,mBAAoBK,GAOpD,IAJAD,EAASD,EAAG,GAAIO,WACXlB,EAAWW,EAAG,MAClBC,GAAU,MAELI,EAAI,EAAGA,EAAIF,EAAGE,IACnBJ,GAAU,WACLI,EAAID,IACRH,GAAU,KAEXA,GAAUD,EAAGK,GAAIE,WACZlB,EAAWW,EAAGK,MAClBJ,GAAU,MAIZ,IAAMI,EAAI,EAAGA,EAAK,GAAGF,EAAE,GAAI,EAAGE,IAC7BJ,GAAU,IAQX,OANAC,EAAMF,EAAG,GAAIO,WACRlB,EAAWW,EAAG,MAClBE,GAAO,MAERA,EAAMd,EAASO,EAAmB,kBAAmBO,GACrDA,EAAMd,EAASc,EAAK,aAAcD,GAC3Bb,EAASc,EAAK,aAAgBD,EAAOK,OA7E7B,GA6EoD,kCAAoC,SC9ExGE"}